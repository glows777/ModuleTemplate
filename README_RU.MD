## Описание структуры модуля расширения ##

Модуль расширения подключается из дополнительной папки после установки Askozia.
Модуль может иметь свой интерфейс, свои файлы стилей, JS скрипты, контроллер, и модель/модели

## Структура папок модуля расширения ##

В папке **app** хранятся подключаемые контроллеры, представления в веб форме, обработчики форм.

В папке **coreapi** хранятся подключаемые автоматически расширения coreapi, которые добавляют новые методы, необходимые для работы модуля

В папке **models** хранятся подключаемые модели

В папке **setup** хранятся файлы необходимые для установки и удаления модуля. Основной файл **PbxExtensionSetup.php**

В папке **messages** хранятся подключаемые файлы перевода ru.php, en.php и т.д.

В корне модуля можно создавать дополнительные папки, например для хранения каких-то бинарников **bin**, желательно после добавления такой папки в структуру дополнить эту инструцию.

Если модуль подразумевает создание собственной базы данных, то можно создать папку **db**

Если модуль будет что-то кешировать или хранить логи, то при установке необходимо предусмотреть создание симлинков на папку **/var/log** или **/var/cache** из одноименных папок внутри структуры модуля.


### Установочный файл  PbxExtensionSetup.php ###
Обязательно содержит следующие функции
  * installDB() - Создает структуру для хранения настроек модуля в своей модели и заполняет настройки по-умолчанию если таблицы не было в системе см. (unInstallDB)
  * installFiles() - Выполняет копирование необходимых файлов, в папки системы
  * unInstallDB () - Удаление модели и настроек, если передан флаг удаления
  * unInstallFiles () - Удаление файлов модуля из системы

### Класс модели ###
Обазательно с namespace вида `Modules\<НазваниеКласса>\Models`, сама модель должна расширять класс **ModelBase**
В модели должна присутвовать функция **getRepresent()** отвечающая за текстовое представление элементов в модели. Например при удалении сотрудника участвующего в настройках модуля, система выведет сообщение о том что в месте с названием **=getRepresent()** есть ссылка на сотрудника.

### Класс контроллера ###
В контроллере, в конце каждого метода имеющего представление, необходимо указывать путь к View файлу конкретного модуля, чтобы система не пыталась искать его по общему пути, где хранится ядро системы.
Напрмер так
`$this->view->pick( "{$modulesDir}/ModuleSmartIVR/app/views/index" );`

### Перевод ###
В массиве фраз с преводом обязательно наличие двух параметров
	* Breadcrumb<НазваниеКласса> - здесь хранится название модуля для заголовка
	* SubHeader<НазваниеКласса> - краткое описание о том что делает этот модуль для подзаголовка